Mercaptopurine's effectiveness and safety are affected by genetic variants in several enzymes crucial to its metabolism, most notably TPMT, ITPA, NUDT15, and NT5C2, which influence drug catabolism, increase toxicity risks, and can cause drug resistance. Genes like SLC28A3 and ABCC4, which mediate drug transport, also play roles in its pharmacokinetics, highlighting the need for patient genotyping to tailor treatments and minimize adverse effects.